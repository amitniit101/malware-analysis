Option Explicit

Dim excelApp, excelWorkbook, excelSheet
Dim targetValue, targetRow

' Set the target value to search for in column 1
targetValue = "SETUP*"

' Create Excel application object
Set excelApp = CreateObject("Excel.Application")
excelApp.Visible = False ' Set to True for visible Excel application

' Open the Excel workbook (replace "YourWorkbook.xlsx" with the actual file path)
Set excelWorkbook = excelApp.Workbooks.Open("D:\Path\To\YourWorkbook.xlsx")

' Assuming data is in the first sheet; update sheet index if needed
Set excelSheet = excelWorkbook.Sheets(1)

' Find the row containing the target value in column 1
Set targetRow = excelSheet.Columns(1).Find(targetValue)

If Not targetRow Is Nothing Then
    ' Delete the entire row if the target value is found
    targetRow.EntireRow.Delete
    ' Save the changes
    excelWorkbook.Save
    ' Close the workbook
    excelWorkbook.Close
    ' Quit Excel application
    excelApp.Quit
    ' Release the Excel objects
    Set targetRow = Nothing
    Set excelSheet = Nothing
    Set excelWorkbook = Nothing
    Set excelApp = Nothing
    WScript.Echo "Row containing '" & targetValue & "' deleted successfully."
Else
    ' If target value is not found, display a message
    excelWorkbook.Close
    excelApp.Quit
    Set excelWorkbook = Nothing
    Set excelApp = Nothing
    WScript.Echo "Target value '" & targetValue & "' not found in column 1."
End If
